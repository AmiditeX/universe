{
  "id": "{{service.name}}",
  "cpus": {{service.cpus}},
  "mem": {{service.mem}},
  "instances": 1,
  "env": {
      "GHOST_HOST": "{{networking.ghost-hostname}}",
      "GHOST_PORT_NUMBER": "{{networking.ghost-port}}",
      "GHOST_USERNAME": "{{ghost.ghost-user}}",
      "GHOST_PASSWORD": "{{ghost.ghost-password}}",
      "GHOST_EMAIL": "{{email.ghost-email}}",
      "SMTP_HOST": "{{email.smtp-host}}",
      "SMTP_PORT": "{{email.smtp-port}}",
      "SMTP_USER": "{{email.smtp-user}}",
      "SMTP_PASSWORD": "{{email.smtp-password}}",
      "SMTP_SERVICE": "{{email.smtp-service}}",
      "BLOG_TITLE": "{{ghost.ghost-title"}},
      "MARIADB_HOST": "{{database.mariadb-host}}",
      "MARIADB_PORT_NUMBER": "{{database.mariadb-port}}",
      "GHOST_DATABASE_NAME": "{{database.ghost-db-name}}",
      "GHOST_DATABASE_USER": "{{database.ghost-db-user}}",
      "GHOST_DATABASE_PASSWORD": "{{database.ghost-db-password}}"
  },
  "portDefinitions": [
      {"port": 0, "protocol": "tcp", "name": "ghost"},
  ],
  "container": {
       "type": "DOCKER",
       "docker": {
           "image": "{{resource.assets.container.docker.ghost}}",
           "network" : "HOST"
       },
   },
   "acceptedResourceRoles": [ "*" ],
   "healthChecks": [
    {
      "path": "/service/{{service.name}}",
      "portIndex": 0,
      "protocol": "MESOS_HTTP",
      "gracePeriodSeconds": 30,
      "intervalSeconds": 60,
      "timeoutSeconds": 20,
      "maxConsecutiveFailures": 3
    }
  ],
  "labels": {
    {{#networking.virtual-host}}
    "HAPROXY_GROUP":"external",
    "HAPROXY_0_VHOST":"{{networking.virtual-host}}",
    "HAPROXY_0_REDIRECT_TO_HTTPS": "{{networking.https-redirect}}",
    {{/networking.virtual-host}}
    "DCOS_PACKAGE_FRAMEWORK_NAME": "{{service.name}}",
    "DCOS_SERVICE_NAME": "{{service.name}}",
    "DCOS_SERVICE_PORT_INDEX": "0",
    "DCOS_SERVICE_SCHEME": "http"
  }
}
